(()=>{"use strict";const e=window.wp.i18n,t=window.wp.blockEditor,s=window.wp.components,o=window.wp.element,l=window.ReactJSXRuntime;wp.blocks.registerBlockType("customblock/slideshow",{title:"SlideShow",icon:"images-alt2",category:"common",attributes:{showTitle:{type:"boolean",default:!0},showExcerpt:{type:"boolean",default:!0},showThumbnail:{type:"boolean",default:!0},autoScroll:{type:"boolean",default:!1},api:{type:"string",default:""},slides:{type:"array",default:[]}},edit:function(n){const{attributes:i,setAttributes:c}=n,{autoScroll:r,api:a,showTitle:h,showExcerpt:d,showThumbnail:u,slides:p}=i,[w,m]=(0,o.useState)([]),[x,g]=(0,o.useState)(0);(0,o.useEffect)((()=>{const e=p.length-1;x<0&&g(e),x>e&&g(0)}),[x,p.length]),(0,o.useEffect)((()=>{if(!r)return;let e=setInterval((()=>{g(x+1)}),2500);return()=>{clearInterval(e)}}),[r,x]),(0,o.useEffect)((()=>{a&&fetch(`${a}/wp-json/wp/v2/posts`).then((e=>e.json())).then((e=>{m(e);const t=j(e);c({slides:[...t]})}))}),[a]);const j=e=>{const t=[];return e.forEach((e=>{const s={};fetch(e._links["wp:featuredmedia"][0].href).then((e=>e.json())).then((e=>{s.thumbnail=e.guid.rendered})),s.title=e.title.rendered,s.excerpt=function(e){let t=e.replace(/<\/?[^>]+(>|$)/g,"");return t=t.replace(/[\[\]\(\)\{\}]/g,""),t.trim()}(e.excerpt.rendered),s.temp=e.excerpt.rendered,s.date=e.date,t.push(s)})),t},f=(0,t.useBlockProps)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(t.InspectorControls,{children:[(0,l.jsxs)(s.PanelBody,{title:(0,e.__)("Slideshow Settings","custom-post-slideshow"),children:[(0,l.jsx)(s.ToggleControl,{label:(0,e.__)("Auto Scroll","custom-post-slideshow"),checked:r,onChange:()=>c({autoScroll:!r})}),(0,l.jsx)(s.TextControl,{label:(0,e.__)("API URL","custom-post-slideshow"),help:(0,e.__)("Enter the custom URL to fetch posts from an external source.","custom-post-slideshow"),value:a,onChange:e=>(e=>{c({api:e})})(e)})]}),(0,l.jsxs)(s.PanelBody,{title:(0,e.__)("Post Meta Settings","custom-post-slideshow"),initialOpen:!1,children:[(0,l.jsx)(s.ToggleControl,{label:(0,e.__)("Show Post Title","custom-post-slideshow"),checked:h,onChange:()=>c({showTitle:!h})}),(0,l.jsx)(s.ToggleControl,{label:(0,e.__)("Show Post Excerpt","custom-post-slideshow"),checked:d,onChange:()=>c({showExcerpt:!d})}),(0,l.jsx)(s.ToggleControl,{label:(0,e.__)("Show Post Thumbnail","custom-post-slideshow"),checked:u,onChange:()=>c({showThumbnail:!u})})]})]}),(0,l.jsx)("div",{...f,children:p.length>0?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"slideshow-container",children:p.map(((e,t)=>{let s="nextSlide";return t===x&&(s="activeSlide"),(t===x-1||0===x&&t===p.length-1)&&(s="lastSlide"),(0,l.jsxs)("article",{className:s,children:[(0,l.jsx)("img",{src:e.thumbnail,alt:e.title,className:"person-img"}),(0,l.jsxs)("div",{className:"slider-content",children:[(0,l.jsx)("h4",{children:e.title}),(0,l.jsx)("p",{className:"title",children:e.date}),(0,l.jsx)("p",{className:"text",children:e.excerpt})]})]},e.title)}))}),(0,l.jsxs)("div",{className:"controls",children:[(0,l.jsx)("button",{className:"prev",onClick:()=>{g((e=>0===e?p.length-1:e-1))},children:"<"}),(0,l.jsx)("button",{className:"next",onClick:()=>{g((e=>(e+1)%p.length))},children:">"})]})]}):a||0===p.length?(0,l.jsx)("p",{children:(0,e.__)("Loading posts...","custom-post-slideshow")}):(0,l.jsx)("p",{children:(0,e.__)("Please enter URL to fetch posts from","custom-post-slideshow")})})]})},save:function(){return null}})})();